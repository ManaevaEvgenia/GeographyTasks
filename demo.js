!function(t){var e={};function s(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=35)}([function(t,e,s){"use strict";var a,n=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},i=function(){var t={};return function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(t){s=null}t[e]=s}return t[e]}}(),r=[];function o(t){for(var e=-1,s=0;s<r.length;s++)if(r[s].identifier===t){e=s;break}return e}function u(t,e){for(var s={},a=[],n=0;n<t.length;n++){var i=t[n],u=e.base?i[0]+e.base:i[0],h=s[u]||0,c="".concat(u," ").concat(h);s[u]=h+1;var l=o(c),d={css:i[1],media:i[2],sourceMap:i[3]};-1!==l?(r[l].references++,r[l].updater(d)):r.push({identifier:c,updater:p(d,e),references:1}),a.push(c)}return a}function h(t){var e=document.createElement("style"),a=t.attributes||{};if(void 0===a.nonce){var n=s.nc;n&&(a.nonce=n)}if(Object.keys(a).forEach((function(t){e.setAttribute(t,a[t])})),"function"==typeof t.insert)t.insert(e);else{var r=i(t.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(e)}return e}var c,l=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function d(t,e,s,a){var n=s?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(t.styleSheet)t.styleSheet.cssText=l(e,n);else{var i=document.createTextNode(n),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(i,r[e]):t.appendChild(i)}}function f(t,e,s){var a=s.css,n=s.media,i=s.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),i&&btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleSheet)t.styleSheet.cssText=a;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(a))}}var v=null,g=0;function p(t,e){var s,a,n;if(e.singleton){var i=g++;s=v||(v=h(e)),a=d.bind(null,s,i,!1),n=d.bind(null,s,i,!0)}else s=h(e),a=f.bind(null,s,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(s)};return a(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;a(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=n());var s=u(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var a=0;a<s.length;a++){var n=o(s[a]);r[n].references--}for(var i=u(t,e),h=0;h<s.length;h++){var c=o(s[h]);0===r[c].references&&(r[c].updater(),r.splice(c,1))}s=i}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),s(2),s(4),s(6)},function(t,e,s){var a=s(0),n=s(3);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var i={insert:"head",singleton:!1};a(n,i);t.exports=n.locals||{}},function(t,e,s){},function(t,e,s){var a=s(0),n=s(5);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var i={insert:"head",singleton:!1};a(n,i);t.exports=n.locals||{}},function(t,e,s){},function(t,e,s){var a={"./assets/fonts/MaterialIcons/MaterialIcons-Regular.eot":7,"./assets/fonts/MaterialIcons/MaterialIcons-Regular.svg":8,"./assets/fonts/MaterialIcons/MaterialIcons-Regular.ttf":9,"./assets/fonts/MaterialIcons/MaterialIcons-Regular.woff":10,"./assets/fonts/MaterialIcons/MaterialIcons-Regular.woff2":11,"./assets/fonts/Merriweather/merriweather-300.eot":12,"./assets/fonts/Merriweather/merriweather-300.svg":13,"./assets/fonts/Merriweather/merriweather-300.ttf":14,"./assets/fonts/Merriweather/merriweather-300.woff":15,"./assets/fonts/Merriweather/merriweather-300.woff2":16,"./assets/fonts/Merriweather/merriweather-bold.eot":17,"./assets/fonts/Merriweather/merriweather-bold.svg":18,"./assets/fonts/Merriweather/merriweather-bold.ttf":19,"./assets/fonts/Merriweather/merriweather-bold.woff":20,"./assets/fonts/Merriweather/merriweather-bold.woff2":21,"./assets/fonts/Merriweather/merriweather-regular.eot":22,"./assets/fonts/Merriweather/merriweather-regular.svg":23,"./assets/fonts/Merriweather/merriweather-regular.ttf":24,"./assets/fonts/Merriweather/merriweather-regular.woff":25,"./assets/fonts/Merriweather/merriweather-regular.woff2":26,"./data/russia.jpg":27,"./data/world.svg":28};function n(t){var e=i(t);return s(e)}function i(t){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}n.keys=function(){return Object.keys(a)},n.resolve=i,t.exports=n,n.id=6},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/MaterialIcons/MaterialIcons-Regular.eot"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/MaterialIcons/MaterialIcons-Regular.svg"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/MaterialIcons/MaterialIcons-Regular.ttf"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/MaterialIcons/MaterialIcons-Regular.woff"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/MaterialIcons/MaterialIcons-Regular.woff2"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-300.eot"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-300.svg"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-300.ttf"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-300.woff"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-300.woff2"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-bold.eot"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-bold.svg"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-bold.ttf"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-bold.woff"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-bold.woff2"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-regular.eot"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-regular.svg"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-regular.ttf"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-regular.woff"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/assets/fonts/Merriweather/merriweather-regular.woff2"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/data/russia.jpg"},function(t,e,s){"use strict";s.r(e),e.default=s.p+"src/data/world.svg"},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={OPACITY:.9,BRUSH_RADIUS:20}},function(t,e,s){"use strict";var a;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.brush=0]="brush",t[t.eraser=1]="eraser"}(a||(a={})),e.default=a},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class a{constructor(t,e){this._x=0,this._y=0,this._x=t,this._y=e}get width(){return this._x}set width(t){this._x=t}get height(){return this._y}set height(t){this._y=t}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}sum(t){return new a(this._x+t.x,this._y+t.y)}sumNumber(t){return new a(this._x+t,this._y+t)}subtract(t){return new a(this._x-t.x,this._y-t.y)}multiplyByNumber(t){return new a(this._x*t,this._y*t)}calculateScalarProduct(t){return this._x*t.x+this._y*t.y}calculateVectorProjectionOnTargetVector(t){return this.calculateScalarProduct(t)/t.length}get length(){return Math.sqrt(this._x*this._x+this._y*this._y)}static calculateVector(t,e){const s=Number.parseFloat(Math.cos(e).toFixed(6)),n=Number.parseFloat(Math.sin(e).toFixed(6));return new a(t*s,t*n)}rotateVector(t){const e=this._x*Math.cos(t)-this._y*Math.sin(t),s=this._x*Math.sin(t)+this._y*Math.cos(t);return new a(e,s)}}e.default=a},,,,function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=a(s(36));s(1),s(59);const i=document.querySelector(".demo");new n.default(i)},function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(37),i=a(s(29)),r=a(s(31)),o=a(s(39)),u=a(s(40)),h=a(s(41)),c=a(s(44)),l=a(s(48)),d=a(s(49)),f=a(s(51)),v=a(s(52));s(57);e.default=class{constructor(t){this.onStartDrawing=new o.default,this.onContinuingDrawing=new o.default,this.onDrawingEnding=new o.default,this.onMouseOver=new o.default,this.onMouseMove=new o.default,this.onMouseOut=new o.default,this.handleSaveButton=()=>{const t=document.createElement("canvas");t.width=this.mapCanvasManager.width,t.height=this.mapCanvasManager.height;const e=t.getContext("2d");e.drawImage(this.mapCanvasManager.canvas,0,0),e.globalAlpha=1,e.drawImage(this.resultCanvasManager.canvas,0,0),t.toBlob(t=>{n.saveAs(t,"pretty image.png")})},this.isDoubleTouch=!1,this.touchIdentifier=-1,this.handleStartDrawing=t=>{if(t instanceof TouchEvent){if(t.changedTouches[0].identifier>0)return;if(!this.isDoubleTouch)return this.isDoubleTouch=!0,void setTimeout(()=>{this.isDoubleTouch=!1},300);t.preventDefault()}t instanceof MouseEvent&&this.isDoubleTouch||(this.cursorCanvasManager.canvas.addEventListener("mousemove",this.handleContinuingDrawing),this.cursorCanvasManager.canvas.addEventListener("mouseup",this.handleEndDrawing),this.cursorCanvasManager.canvas.addEventListener("touchmove",this.handleContinuingDrawing),this.cursorCanvasManager.canvas.addEventListener("touchend",this.handleEndDrawing),this.onStartDrawing.invoke(new f.default({mousePosition:this.calculateMousePositionInsideCanvases(t),button:t.button})))},this.handleContinuingDrawing=t=>{this.onContinuingDrawing.invoke(new f.default({mousePosition:this.calculateMousePositionInsideCanvases(t),button:t.button}))},this.handleEndDrawing=t=>{this.cursorCanvasManager.canvas.removeEventListener("mousemove",this.handleContinuingDrawing),this.cursorCanvasManager.canvas.removeEventListener("mouseup",this.handleEndDrawing),this.cursorCanvasManager.canvas.removeEventListener("touchmove",this.handleContinuingDrawing),this.cursorCanvasManager.canvas.removeEventListener("touchend",this.handleEndDrawing),this.onDrawingEnding.invoke(new f.default({mousePosition:this.calculateMousePositionInsideCanvases(t),button:t.button}))},this.handleCanvasMouseOver=t=>{t instanceof MouseEvent&&this.isDoubleTouch||(this.cursorCanvasManager.canvas.addEventListener("mousemove",this.handleCanvasMouseMove),this.cursorCanvasManager.canvas.addEventListener("mouseout",this.handleCanvasMouseOut),this.onMouseOver.invoke(new f.default({mousePosition:this.calculateMousePositionInsideCanvases(t),button:t.button})))},this.handleCanvasMouseMove=t=>{this.onMouseMove.invoke(new f.default({mousePosition:this.calculateMousePositionInsideCanvases(t),button:t.button}))},this.handleCanvasMouseOut=t=>{this.cursorCanvasManager.canvas.removeEventListener("mousemove",this.handleCanvasMouseMove),this.cursorCanvasManager.canvas.removeEventListener("mouseout",this.handleCanvasMouseOut),this.onMouseOut.invoke(new f.default({mousePosition:this.calculateMousePositionInsideCanvases(t),button:t.button}))},this.container=t,this.initialize(),this.setEventsHandlers();const e=new r.default(this.canvasWidth,this.canvasHeight);this.map=new d.default((u.default.forGithubPages?"/GeographyTasks":"")+"/src/data/russia.jpg",e),this.map.draw(this.mapCanvasManager),this.undoButton=new v.default(this),this.tempCanvasManager.canvas.style.opacity=""+i.default.OPACITY}initialize(){const t=this.calculateBiggestSide();this.canvasesContainer=this.container.querySelector(".task__canvases"),this.canvasesContainer.style.height=.5*t+"px";const e=this.container.querySelector(".task__map-canvas"),s=this.container.querySelector(".task__result-canvas"),a=this.container.querySelector(".task__temp-canvas"),n=this.container.querySelector(".task__cursor-canvas"),i=this.container.querySelector(".task__dropdown-form"),r=this.container.querySelector(".task__drawing-options-panel");this.saveButton=this.container.querySelector(".dropdown-form__save-button"),this.mapCanvasManager=new l.default(e,this.canvasWidth,this.canvasHeight),this.resultCanvasManager=new l.default(s,this.canvasWidth,this.canvasHeight),this.tempCanvasManager=new l.default(a,this.canvasWidth,this.canvasHeight),this.cursorCanvasManager=new l.default(n,this.canvasWidth,this.canvasHeight),this.dropdownForm=new h.default(i),this.drawingOptionsPanel=new c.default(r,this)}setEventsHandlers(){this.cursorCanvasManager.canvas.ondragstart=()=>!1,this.cursorCanvasManager.canvas.addEventListener("mousedown",this.handleStartDrawing),this.cursorCanvasManager.canvas.addEventListener("touchstart",this.handleStartDrawing),this.cursorCanvasManager.canvas.addEventListener("mouseover",this.handleCanvasMouseOver),this.saveButton.addEventListener("click",this.handleSaveButton)}calculateBiggestSide(){let t=document.documentElement.clientWidth>document.documentElement.clientHeight?document.documentElement.clientWidth:document.documentElement.clientHeight;return t<1e3&&(t=1e3),this.canvasWidth=t-0*t,this.canvasHeight=.5*t,t}extractMousePosition(t){let e,s;return t instanceof TouchEvent?(e=t.changedTouches[0].pageX-window.pageXOffset,s=t.changedTouches[0].pageY-window.pageYOffset):t instanceof MouseEvent&&(e=t.clientX,s=t.clientY),new r.default(e,s)}calculateMousePositionInsideCanvases(t){const e=this.extractMousePosition(t),s=this.mapCanvasManager.canvas.getBoundingClientRect(),a=new r.default(s.x,s.y);return e.subtract(a)}}},function(t,e,s){(function(s){var a,n,i;n=[],void 0===(i="function"==typeof(a=function(){"use strict";function e(t,e,s){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){r(a.response,e,s)},a.onerror=function(){console.error("could not download file")},a.send()}function a(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function n(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(s){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof s&&s.global===s?s:void 0,r=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype?function(t,s,r){var o=i.URL||i.webkitURL,u=document.createElement("a");s=s||t.name||"download",u.download=s,u.rel="noopener","string"==typeof t?(u.href=t,u.origin===location.origin?n(u):a(u.href)?e(t,s,r):n(u,u.target="_blank")):(u.href=o.createObjectURL(t),setTimeout((function(){o.revokeObjectURL(u.href)}),4e4),setTimeout((function(){n(u)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,s,i){if(s=s||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,i),s);else if(a(t))e(t,s,i);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout((function(){n(r)}))}}:function(t,s,a,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return e(t,s,a);var r="application/octet-stream"===t.type,o=/constructor/i.test(i.HTMLElement)||i.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||r&&o)&&"object"==typeof FileReader){var h=new FileReader;h.onloadend=function(){var t=h.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=t:location=t,n=null},h.readAsDataURL(t)}else{var c=i.URL||i.webkitURL,l=c.createObjectURL(t);n?n.location=l:location.href=l,n=null,setTimeout((function(){c.revokeObjectURL(l)}),4e4)}});i.saveAs=r.saveAs=r,t.exports=r})?a.apply(e,n):a)||(t.exports=i)}).call(this,s(38))},function(t,e){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(t){"object"==typeof window&&(s=window)}t.exports=s},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){this.handlers=new Array,this.invoke=t=>{this.handlers.forEach(e=>e(t))},this.subscribe=t=>{this.handlers.push(t)},this.unsubscribe=t=>{const e=this.handlers.indexOf(t);e>-1&&this.handlers.splice(e,1)}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={forGithubPages:!0}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),s(42);e.default=class{constructor(t){this.isOpened=!1,this.handleArrowClick=()=>{this.isOpened=!this.isOpened,this.updateState()},this.handleDropdownLeave=t=>{t.target.closest(".dropdown-form")||(this.isOpened=!1,this.updateState())},this.container=t,this.initialize(),this.setEventsHandlers(),this.updateState()}initialize(){this.dropButton=this.container.querySelector(".dropdown-form__drop-button"),this.arrow=this.container.querySelector(".dropdown-form__arrow"),this.form=this.container.querySelector(".dropdown-form__form")}setEventsHandlers(){this.dropButton.addEventListener("click",this.handleArrowClick),document.addEventListener("click",this.handleDropdownLeave)}updateState(){this.dropButton.classList.toggle("dropdown-form__drop-button_opened",this.isOpened),this.arrow.classList.toggle("dropdown-form__arrow_opened",this.isOpened),this.form.classList.toggle("dropdown-form__form_opened",this.isOpened)}}},function(t,e,s){var a=s(0),n=s(43);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var i={insert:"head",singleton:!1};a(n,i);t.exports=n.locals||{}},function(t,e,s){},function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=a(s(29)),i=a(s(30));s(45);const r=a(s(47));e.default=class{constructor(t,e){this.handleRadioClick=t=>{const e=t.target,{name:s}=e.dataset;switch(s){case"brush":this.toolsManager.brushType=i.default.brush;break;case"eraser":this.toolsManager.brushType=i.default.eraser;break;default:this.toolsManager.brushType=i.default.brush}},this.handleOpacityInput=t=>{const e=t.target;this.toolsManager.opacity=Number.parseFloat(e.value),this.toolsManager.opacity<0?(e.value="0",this.toolsManager.opacity=0):this.toolsManager.opacity>1&&(e.value="1",this.toolsManager.opacity=1)},this.handleBrushSizeInput=t=>{const e=t.target;this.toolsManager.brushRadius=Number.parseInt(e.value,10),this.toolsManager.brushRadius<1?(e.value="1",this.toolsManager.brushRadius=1):this.toolsManager.brushRadius>100&&(e.value="100",this.toolsManager.brushRadius=100)},this.handleOpacityChange=t=>{const e=t.target,s=Number.parseFloat(e.value);void 0===s||Number.isNaN(s)?(this.toolsManager.opacity=1,e.value="1"):(this.toolsManager.opacity=s,e.value=""+s)},this.handleBrushSizeChange=t=>{const e=t.target,s=Number.parseFloat(e.value);void 0===s||Number.isNaN(s)?(this.toolsManager.brushRadius=1,e.value="1"):(this.toolsManager.brushRadius=s,e.value=""+s)},this.container=t,this.task=e,this.initialize(),this.setEventsHandlers(),this.brush.checked=!0,this.opacityInput.value=""+n.default.OPACITY,this.brushSizeInput.value=""+n.default.BRUSH_RADIUS,this.toolsManager=new r.default(e)}initialize(){this.eraser=this.container.querySelector(".drawing-options-panel__eraser"),this.brush=this.container.querySelector(".drawing-options-panel__brush"),this.opacityInput=this.container.querySelector(".drawing-options-panel__opacity-input"),this.brushSizeInput=this.container.querySelector(".drawing-options-panel__brush-size-input")}setEventsHandlers(){this.eraser.addEventListener("click",this.handleRadioClick),this.brush.addEventListener("click",this.handleRadioClick),this.opacityInput.addEventListener("input",this.handleOpacityInput),this.brushSizeInput.addEventListener("input",this.handleBrushSizeInput),this.opacityInput.addEventListener("change",this.handleOpacityChange),this.brushSizeInput.addEventListener("change",this.handleBrushSizeChange)}}},function(t,e,s){var a=s(0),n=s(46);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var i={insert:"head",singleton:!1};a(n,i);t.exports=n.locals||{}},function(t,e,s){},function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=a(s(29)),i=a(s(30));e.default=class{constructor(t){this.brushRadius=n.default.BRUSH_RADIUS,this.opacity=n.default.OPACITY,this.brushType=i.default.brush,this.setEventsHandlers=()=>{this.task.onStartDrawing.subscribe(this.mouseDown),this.task.onContinuingDrawing.subscribe(this.mouseMove),this.task.onDrawingEnding.subscribe(this.mouseUp),this.task.onMouseOver.subscribe(this.mouseOver),this.task.onMouseMove.subscribe(this.mouseOver),this.task.onMouseOver.subscribe(this.mouseOut)},this.mouseDown=t=>{this.task.tempCanvasManager.canvas.style.opacity=""+this.opacity,this.brushType===i.default.brush?this.task.tempCanvasManager.beginDrawing(t.data.mousePosition,this.brushRadius):this.brushType===i.default.eraser&&this.task.resultCanvasManager.erase(t.data.mousePosition,this.brushRadius)},this.mouseMove=t=>{this.brushType===i.default.brush?this.task.tempCanvasManager.continuousDrawing(t.data.mousePosition,this.brushRadius):this.brushType===i.default.eraser&&this.task.resultCanvasManager.erase(t.data.mousePosition,this.brushRadius)},this.mouseUp=()=>{this.task.resultCanvasManager.context.globalAlpha=this.opacity,this.task.resultCanvasManager.context.drawImage(this.task.tempCanvasManager.canvas,0,0),this.task.tempCanvasManager.context.clearRect(0,0,this.task.resultCanvasManager.width,this.task.resultCanvasManager.height)},this.mouseOver=t=>{this.task.cursorCanvasManager.drawBrush(t.data.mousePosition,this.brushRadius,this.brushType)},this.mouseOut=()=>{this.task.cursorCanvasManager.context.clearRect(0,0,this.task.cursorCanvasManager.width,this.task.cursorCanvasManager.height)},this.task=t,this.initialize(),this.setEventsHandlers()}initialize(){}}},function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=a(s(31)),i=a(s(30));e.default=class{constructor(t,e,s){this.setSize=()=>{this.canvas.width=this.width,this.canvas.height=this.height},this.erase=(t,e)=>{this.context.clearRect(t.x-e,t.y-e,2*e,2*e)},this.beginDrawing=(t,e)=>{if(e<20){this.context.beginPath();const s="rgba(0, 0, 0, 1)";this.context.strokeStyle=s,this.context.lineWidth=2*e,this.context.lineCap="round",this.context.lineTo(t.x,t.y),this.context.stroke()}else{const s="rgba(0, 0, 0, 1)";this.context.fillStyle=s,this.context.beginPath(),this.context.arc(t.x,t.y,e,0,2*Math.PI),this.context.fill()}},this.continuousDrawing=(t,e)=>{if(e<20){const s="rgba(0, 0, 0, 1)";this.context.strokeStyle=s,this.context.lineWidth=2*e,this.context.lineCap="round",this.context.lineTo(t.x,t.y),this.context.stroke()}else{const s="rgba(0, 0, 0, 1)";this.context.fillStyle=s,this.context.beginPath(),this.context.arc(t.x,t.y,e,0,2*Math.PI),this.context.fill()}},this.canvas=t,this.context=t.getContext("2d"),this.width=e,this.height=s,this.initialaze()}initialaze(){this.setSize()}drawImage(t){if(t.isImageLoaded){const e=t.position.x+t.size.width/2,s=t.position.y+t.size.height/2,a=-t.size.width/2,n=-t.size.height/2;this.context.setTransform(1,0,0,1,e,s),this.context.rotate(t.angle),this.context.drawImage(t.image,a,n,t.size.width,t.size.height),this.context.resetTransform()}else{const e=new n.default(t.position.x,t.position.y);this.drawSquare(e,t.size,"rgb(12, 123, 222)")}}drawSquare(t,e,s){this.context.fillStyle=s,this.context.fillRect(t.x,t.y,e.width,e.height)}drawBrush(t,e,s){if(this.context.clearRect(0,0,this.width,this.height),s===i.default.brush){const s="rgba(0, 0, 0, 1)";this.context.fillStyle=s,this.context.lineWidth=1,this.context.beginPath(),this.context.arc(t.x,t.y,e,0,2*Math.PI),this.context.closePath(),this.context.stroke()}else s===i.default.eraser&&(this.context.beginPath(),this.context.rect(t.x-e,t.y-e,2*e,2*e),this.context.closePath(),this.context.strokeStyle="black",this.context.stroke())}}},function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=a(s(50));e.default=class{constructor(t,e){this.position=new n.default(0,0),this.size=new n.default(0,0),this.angle=0,this.isImageLoaded=!1,this.size=e,this.image=new Image,this.image.src=t,this.image.onload=()=>{this.isImageLoaded=!0}}draw(t){if(this.isImageLoaded)t.drawImage(this);else{const e=setInterval(()=>{this.isImageLoaded&&clearInterval(e),t.drawImage(this)},500)}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class a{constructor(t,e){this._x=0,this._y=0,this._x=t,this._y=e}get width(){return this._x}set width(t){this._x=t}get height(){return this._y}set height(t){this._y=t}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}sum(t){return new a(this._x+t.x,this._y+t.y)}sumNumber(t){return new a(this._x+t,this._y+t)}subtract(t){return new a(this._x-t.x,this._y-t.y)}multiplyByNumber(t){return new a(this._x*t,this._y*t)}calculateScalarProduct(t){return this._x*t.x+this._y*t.y}calculateVectorProjectionOnTargetVector(t){return this.calculateScalarProduct(t)/t.length}get length(){return Math.sqrt(this._x*this._x+this._y*this._y)}static calculateVector(t,e){const s=Number.parseFloat(Math.cos(e).toFixed(6)),n=Number.parseFloat(Math.sin(e).toFixed(6));return new a(t*s,t*n)}rotateVector(t){const e=this._x*Math.cos(t)-this._y*Math.sin(t),s=this._x*Math.sin(t)+this._y*Math.cos(t);return new a(e,s)}}e.default=a},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t){this.data=t}}},function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=a(s(53));s(55);e.default=class{constructor(t){this.trySetDrawingFromLocalStorage=()=>{const t=localStorage.getItem("lastDrawing");if(t){const e=new Image;e.src=t,e.onload=()=>{this.task.resultCanvasManager.context.clearRect(0,0,this.task.canvasWidth,this.task.canvasHeight),this.task.resultCanvasManager.context.globalAlpha=1,this.task.resultCanvasManager.context.drawImage(e,0,0),this.saveLastDrawingState()}}},this.handleButtonClick=()=>{this.undo()},this.saveLastDrawingState=()=>{const t=this.task.resultCanvasManager.canvas.toDataURL("image/png");this.drawingStates.add(t)},this.saveToLocalStorage=()=>{const t=this.task.resultCanvasManager.canvas.toDataURL("image/png");localStorage.setItem("lastDrawing",t)},this.task=t,this.drawingStates=new n.default,this.initialize(),this.setEventsHandlers(),this.trySetDrawingFromLocalStorage()}initialize(){this.button=this.task.container.querySelector(".undo-button")}setEventsHandlers(){this.button.addEventListener("click",this.handleButtonClick),this.task.onDrawingEnding.subscribe(this.saveLastDrawingState),this.task.onDrawingEnding.subscribe(this.saveToLocalStorage)}undo(){const{length:t}=this.drawingStates;if(t<=1)return;this.drawingStates.removeLast();const e=new Image;e.src=this.drawingStates.head.value,e.onload=()=>{this.task.resultCanvasManager.context.clearRect(0,0,this.task.canvasWidth,this.task.canvasHeight),this.task.resultCanvasManager.context.globalAlpha=1,this.task.resultCanvasManager.context.drawImage(e,0,0),this.saveToLocalStorage()}}}},function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=a(s(54));class i{constructor(){this.initialize()}get length(){let t=0;for(let e of this)t+=1;return t}initialize(){this.head=void 0,this.tail=this.head}add(t){if(void 0===this.head||void 0===this.tail){const e={next:void 0,previous:void 0,value:t};this.head=e,this.tail=this.head}else{const e={next:void 0,previous:this.head,value:t};this.head.next=e,this.head=this.head.next}}removeLast(){if(this.head){const t=this.head;return this.head=this.head.previous,this.head&&(this.head.next=void 0),t.value}return null}removeFirst(){if(this.tail){const t=this.tail;return this.tail=this.tail.next,this.tail&&(this.tail.previous=void 0),t.value}return null}[Symbol.iterator](){return new n.default(this)}}e.default=i},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t){this.list=t,this.current=this.list.tail,this.isDone=!1}next(){let t;if(void 0===this.list.head||void 0===this.list.tail)t={value:void 0,done:!0};else{if(t={value:this.current,done:this.isDone},this.isDone)return t;this.current=this.current.next,this.isDone=void 0===this.current}return t}}},function(t,e,s){var a=s(0),n=s(56);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var i={insert:"head",singleton:!1};a(n,i);t.exports=n.locals||{}},function(t,e,s){},function(t,e,s){var a=s(0),n=s(58);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var i={insert:"head",singleton:!1};a(n,i);t.exports=n.locals||{}},function(t,e,s){},function(t,e,s){var a=s(0),n=s(60);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var i={insert:"head",singleton:!1};a(n,i);t.exports=n.locals||{}},function(t,e,s){}]);
//# sourceMappingURL=demo.js.map?v=e03e3e3f0affda6f4eaa